var CoreModule=function(t,e,r){"use strict";var o=e.getNativeModule("Core");var a=(n.prototype.isEmpty=function(){return 0==this.value},n.prototype.equals=function(t){return this.value===t.value},n.EMPTY=new n(0),n);function n(t){this.value=t}function i(t){var e;return new u(new a(t.id),t.kind,null!=(e=t.constants)?e:{})}var u=(l.prototype.getBoolSignal=function(t){return new r.BoolSignal(o.getBoolSignal(this.id.value,t))},l.prototype.getScalarSignal=function(t){return new r.ScalarSignal(o.getScalarSignal(this.id.value,t))},l.prototype.getStringSignal=function(t){return new r.StringSignal(o.getStringSignal(this.id.value,t))},l.prototype.getEnumSignal=function(t){return new r.StringSignal(o.getEnumSignal(this.id.value,t))},l.prototype.getDimenSignal=function(t){return new r.ScalarSignal(o.getDimenSignal(this.id.value,t))},l.prototype.getTransformSignal=function(t){return new r.TransformSignal(o.getTransformSignal(this.id.value,t))},l.prototype.getBool=function(t){return r.eventSourceToPromise(o.getBoolProp(this.id.value,t))},l.prototype.getScalar=function(t){return r.eventSourceToPromise(o.getScalarProp(this.id.value,t))},l.prototype.getString=function(t){return r.eventSourceToPromise(o.getStringProp(this.id.value,t))},l.prototype.getBoolSync=function(t){return o.getBoolPropSync(this.id.value,t)},l.prototype.getScalarSync=function(t){return o.getScalarPropSync(this.id.value,t)},l.prototype.getStringSync=function(t){return o.getStringPropSync(this.id.value,t)},l.prototype.getEnumSync=function(t){return o.getEnumPropSync(this.id.value,t)},l.prototype.getDimenSync=function(t){return o.getDimenPropSync(this.id.value,t)},l.prototype.setBoolProp=function(t,e){"boolean"==typeof e?o.setBool(this.id.value,t,e):o.bindBool(this.id.value,t,r.ref(e))},l.prototype.setScalarProp=function(t,e){"number"==typeof e?o.setScalar(this.id.value,t,e):o.bindScalar(this.id.value,t,r.ref(e))},l.prototype.setStringProp=function(t,e){"string"==typeof e?o.setString(this.id.value,t,e):o.bindString(this.id.value,t,r.ref(e))},l.prototype.setStringAsync=function(t,e){return r.eventSourceToPromise(o.setStringAsync(this.id.value,t,e)).then(function(t){})},l.prototype.setDimenProp=function(t,e){"number"==typeof e?o.setDimen(this.id.value,t,e):o.bindDimen(this.id.value,t,r.ref(e))},l.prototype.setColorProp=function(t,e){o.bindScalar(this.id.value,t,r.ref(r.toBgrxSignal(e)))},l.prototype.setHsvaVecProp=function(t,e){o.bindScalar(this.id.value,t+"/x",r.ref(e._components[0])),o.bindScalar(this.id.value,t+"/y",r.ref(e._components[1])),o.bindScalar(this.id.value,t+"/z",r.ref(e._components[2])),o.bindScalar(this.id.value,t+"/w",r.ref(e._components[3]))},l.prototype.notifyChanged=function(t){o.notifyChanged(this.id.value,t)},l.prototype.getArrayRefProp=function(t){return r.eventSourceToPromise(o.getArrayRefProp(this.id.value,t)).then(i)},l.prototype.getArrayRefPropSync=function(t){var e=o.getArrayRefPropSync(this.id.value,t);return null==e?null:i(e)},l.prototype.getChildren=function(){return r.eventSourceToPromise(o.getChildren(this.id.value)).then(function(t){return t.map(i)})},l.prototype.getChildrenSync=function(){return o.getChildrenSync(this.id.value).map(i)},l.prototype.addChild=function(t){return r.eventSourceToPromise(o.connectToParent(t.id.value,this.id.value)).then(function(t){})},l.prototype.destroy=function(){if(this.id.equals(a.EMPTY))return Promise.resolve();var e=this;return r.eventSourceToPromise(o.remove(this.id.value)).then(function(t){return v.remove(e.id)})},l);function l(t,e,n){this.id=t,this.kind=e,this.constants=n}var s,c,d=function(t,e,n){this.parent=a.EMPTY,this.next=a.EMPTY,this.prev=a.EMPTY,this.firstChild=a.EMPTY,this.lastChild=a.EMPTY,this.ref=new u(t,e,null!=n?n:{})};function p(){this.nodes=[null],this.onConnected={},this.onDisconnected={};var e=this;o.registerModelSyncHandler(function(t){return e.apply(t)})}(c=s=s||{})[c["CONTINUE"]=0]="CONTINUE",c[c["SKIP_CHILDREN"]=1]="SKIP_CHILDREN",c[c["STOP"]=2]="STOP";var f,h,v=new(p.prototype.create=function(t,e){return r.eventSourceToPromise(o.create(t,0,e)).then(function(t){return v.apply({removed:[],updated:[t]}),v.getOrThrow(new a(t.id))})},p.prototype.clone=function(t,e){return r.eventSourceToPromise(o.clone(t.id.value,0,e)).then(function(t){return v.apply({removed:[],updated:[t]}),v.getOrThrow(new a(t.id))})},p.prototype.apply=function(t){for(var e=0;e<t.removed.length;++e)this.remove(new a(t.removed[e]));for(e=0;e<t.updated.length;++e)this.update(t.updated[e])},p.prototype.get=function(t){var e;return null===(e=this.nodes[t.value])||void 0===e?void 0:e.ref},p.prototype.getOrThrow=function(t){return this.getNode(t).ref},p.prototype.getNode=function(t){var e=this.nodes[t.value];if(null==e)throw new Error("Node not found for id "+t.value);return e},p.prototype.update=function(t){var e,n=new a(t.id),r=this.nodes[t.id];if(null==r){for(r=new d(n,t.kind,t.constants);this.nodes.length<t.id;)this.nodes.push(null);this.nodes[t.id]=r}else r.ref.kind=t.kind,r.ref.constants=null!=(e=t.constants)?e:r.ref.constants;r.parent.isEmpty()||this.disconnect(n),t.parent&&this.connect(n,new a(t.parent),t.prev?new a(t.prev):void 0)},p.prototype.connect=function(t,e,n){var r,o=this.getNode(t);o.parent=e;var i=this.nodes[e.value];if(i){if(null==n)o.prev=a.EMPTY,o.next=i.firstChild,i.firstChild=t,i.lastChild.isEmpty()&&(i.lastChild=i.firstChild);else{var u=this.getNode(n);o.prev=n,o.next=u.next,u.next=t,i.lastChild.equals(n)?i.lastChild=t:this.getNode(o.next).prev=t}null!==(r=this.onConnected[e.value])&&void 0!==r&&r.notify(o.ref)}else o.prev=a.EMPTY,o.next=a.EMPTY},p.prototype.disconnect=function(t){var e,n=this.nodes[t.value];if(n){var r=n.parent.value,o=this.nodes[r];o&&(o.firstChild.equals(t)&&(o.firstChild=n.next),o.lastChild.equals(t)&&(o.lastChild=n.prev)),n.prev.isEmpty()||(this.getNode(n.prev).next=n.next),n.next.isEmpty()||(this.getNode(n.next).prev=n.prev),n.parent=a.EMPTY,n.prev=a.EMPTY,n.next=a.EMPTY,null!==(e=this.onDisconnected[r])&&void 0!==e&&e.notify(n.ref)}},p.prototype.remove=function(t){this.disconnect(t);var e=this.nodes[t.value];null!=e&&(e.ref.id=a.EMPTY,this.nodes[t.value]=null,delete this.onConnected[t.value],delete this.onDisconnected[t.value])},p.prototype.dfs=function(t,e){for(var n=this.getNode(t).firstChild;!n.isEmpty();){var r=this.getNode(n),o=e(r.ref);if(o==s.STOP)return;if(o!=s.CONTINUE||r.firstChild.isEmpty()){for(;!n.equals(t)&&r.next.isEmpty();)n=r.parent,r=this.getNode(n);if(n.equals(t))return;n=r.next}else n=r.firstChild}},p.prototype.onChildConnected=function(t){var e;return null!=(e=this.onConnected[t.value])?e:this.onConnected[t.value]=new r.Observable},p.prototype.onChildDisconnected=function(t){var e;return null!=(e=this.onDisconnected[t.value])?e:this.onDisconnected[t.value]=new r.Observable},p),g=Object.freeze({__proto__:null,NodeId:a,nodeToModelRef:i,ModelRef:u,get DfsVisitBehavior(){return s},graph:v});(h=f=f||{})[h["CHAR"]=0]="CHAR",h[h["WILDCARD"]=1]="WILDCARD";var S=(y.prototype.isWildcard=function(){return this.kind==f.WILDCARD},y);function y(t,e){this.kind=t,this.char=null!=e?e:""}var m=(P.prototype.matches=function(t){for(var e=[!0],n=0;n<t.length;++n)e.push(!1);for(var r=0;r<this.tokens.length;++r){var o=this.tokens[r],i=e[0];for(e[0]=e[0]&&o.isWildcard(),n=0;n<t.length;++n){var u=e[n+1];e[n+1]=o.isWildcard()?u||e[n]:i&&t.charAt(n)==o.char,i=u}}return e[t.length]},P);function P(t){this.tokens=[],this.tokens="string"==typeof t?function(t){for(var e=[],n=!1,r=0;r<t.length;++r){var o=t.charAt(r);"\\"!==o||n?"*"!==o||n?(e.push(new S(f.CHAR,o)),n=!1):e.push(new S(f.WILDCARD)):n=!0}return e}(t):t}function C(t,e,n,r){var o=[];return v.dfs(t,function(t){return e(t)&&o.push(t),null==r||r<1||o.length<r?n?s.CONTINUE:s.SKIP_CHILDREN:s.STOP}),o}function T(t,e){var n=t.constants[e];return null==n||"string"!=typeof n?void 0:n}var E=Object.freeze({__proto__:null,Pattern:m,children:function(t){var e=[];return v.dfs(t,function(t){return e.push(t),s.SKIP_CHILDREN}),e},findByName:function(t,e,n,r){var o=new m(e);return C(t,function(t){var e=T(t,"name");return null!=e&&o.matches(e)},n,r)},findByIdentifier:function(t,e,n,r){return C(t,function(t){return T(t,"identifier")===e},n,r)}});return t.getCoreModule=function(){return o},t.log=function(t){o.log(t)},t.mapScalarToString=function(t,e,n){return new r.StringSignal(o.mapScalarToString(r.ref(t),e,n))},t.mapStringToScalar=function(t,e,n){return new r.ScalarSignal(o.mapStringToScalar(r.ref(t),e,n))},t.model=g,t.model_search=E,t}({},arfx,ReactiveModule);